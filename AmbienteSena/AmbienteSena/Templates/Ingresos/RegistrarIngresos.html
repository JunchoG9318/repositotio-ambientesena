{% include 'Inc/header.html' %}

{% if messages %}
    {% for mensaje in messages %}
    <div class="ui container" id="mensajes">
        <div class="ui {{ mensaje.tags }} message">
            <i class="close icon"></i>
            <div class="header">
                {{ mensaje }}
            </div>
        </div>
    </div>
    {% endfor %}
{% endif %}

<div class="ui container">
    <h1>Registrar Asignación de Ingresos</h1>

    <form action="" method="post" id="formularioingreso" class="ui form">
        {% csrf_token %}
        <!-- PRIMERA FILA -->
        <div class="two fields">
            <div class="field">
                <label for="instructor">Instructor</label>
                <select name="instructor" id="instructor" class="ui dropdown">
                    <option value="">Seleccione un Instructor</option>
                    {% for instructor in instructores %}
                    <option value="{{ instructor.id }}">{{ instructor.NombreCompleto }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="field">
                <label for="ambiente">Ambiente</label>
                <select name="ambiente" id="ambiente" class="ui dropdown">
                    <option value="">Seleccione el ambiente</option>
                    {% for ambiente in ambientes %}
                    <option value="{{ ambiente.id }}">{{ ambiente.NombreAmbiente }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        <!-- FIN PRIMERA FILA -->
        
        <!-- SEGUNDA FILA -->
        <div class="field">
            <label for="observacion">Observación</label>
            <textarea name="observacion" id="observacion" rows="3"></textarea>
        </div>
        <!-- FIN SEGUNDA FILA -->
        
        <button type="submit" class="ui primary button">Registrar Ingreso</button>
        <a href="/Ingresos/ListarIngresos" class="ui button">Cancelar</a>
    </form>
</div>

{% include 'Inc/footer.html' %}

<script>
    $(document).ready(function() {
        // Inicializar dropdowns de Semantic UI
        $('.ui.dropdown').dropdown();
        
        // Validación del formulario
        $("#formularioingreso").form({
            inline: true,
            fields: {
                instructor: {
                    identifier: 'instructor',
                    rules: [{
                        type: 'empty',
                        prompt: 'Por favor seleccione un instructor'
                    }]
                },
                ambiente: {
                    identifier: 'ambiente',
                    rules: [{
                        type: 'empty',
                        prompt: 'Por favor seleccione un ambiente'
                    }]
                },
            }
        });
        
        // Cerrar mensajes
        $('.message .close').on('click', function() {
            $(this).closest('.message').transition('fade');
        });
    });
</script>